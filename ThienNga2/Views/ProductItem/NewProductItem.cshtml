@using ThienNga2.Models;
@using ThienNga2.Models.Entities;
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>NewProductItem</title>
    <link rel="stylesheet" type="text/css" href="~/Content/formTemplate.css">
 
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.8.1/jquery.validate.js">
    </script>
    <script src="~/Scripts/jquery.validate.unobtrusive.js">
    </script>
    <script>
        function checkHidden() {
            var flag = true;
            for (i = 0; i < 20; i++) {
                var value = $("#warrantyDiv" + i + " #war_warrantyID").val();
               
                if (flag) {
                    if (value == null || value == "") {
                        $("#warrantyDiv" + i).show();
                        flag = false;
                    }
                }
                else {
                    $("#warrantyDiv" + i).hide();
                }
            }
            $(".ui-helper-hidden-accessible").hide();
        }
 
        setInterval(checkHidden, 100);
    </script>
    <script>
        $(document).ready(function () {
            $('#item_tb_product_detail_producFactoryID').autocomplete({
                source: '@Url.Action("Autocomplete")'
                
            })
                .data("ui-autocomplete")._renderItem = function (ul, item) {
                    return $("<li>")
                      .data("ui-autocomplete-item", item)
                      .append('<a style="color:black">' + item.label +"</a>")
                      .appendTo(ul);
                };

            $("#warrantyDiv1 war_warrantyID").on('input', function () {
                // do your stuff

            });
            
        });
        
    </script>
    
</head>
<body>
    @using (Html.BeginForm("CreateWhenSale", "ProductItem"))
    {
        int id = 0;
        bool myFlag = true;
        List<SelectListItem> ls = new List<SelectListItem> {
     new SelectListItem { Text = "1 tháng", Value = "1"},
     new SelectListItem { Text = "2  tháng", Value = "2"},
     new SelectListItem { Text = "3 tháng", Value = "3"},
     new SelectListItem { Text  = "6 tháng",Value="6"},
     new SelectListItem { Text = "12 tháng", Value = "12" },
     new SelectListItem { Text = "24 tháng", Value = "24" }
    }; List<SelectListItem> ls2 = new List<SelectListItem>();
        foreach (tb_inventory_name kho in (List
                <tb_inventory_name>
                    )ViewData["dsk"] ) {
            ls2.Add(new SelectListItem { Text =kho.InventoryName, Value = kho.id+"" });
        }


        @model ThienNga2.Models.ViewModel.NewItemViewModel
        
        <div class="form-style-10">
            <h1>Tạo đơn hàng<span>Bán và kich hoạt bảo hành</span></h1>
            <form>
                <label>Ngày/tháng/năm @Html.TextBoxFor(Model => Model.item.DateOfSold) </label>
                <div class="section"><span>1</span>Thông tin khách hàng</div>
                <div class="inner-wrap">
                    <label>Tên khách hàng @Html.TextBoxFor(Model => Model.item.tb_customer.customerName)</label>
                    <label>SDT @Html.TextBoxFor(Model => Model.item.tb_customer.phonenumber)</label>
                    <label>Địa chỉ @Html.TextBoxFor(Model => Model.item.tb_customer.address)</label>
                </div>

                <div class="section"><span>2</span>Thông tin sản phẩm</div>
                <div class="inner-wrap">
                    <label>Tên/Mã nhà máy/Mã cửa hàng @Html.TextBoxFor(Model => Model.item.tb_product_detail.producFactoryID)</label>
                    <label>Lấy từ kho @Html.DropDownListFor(Model => Model.item.inventoryID, ls2)</label>
                    <label>Nhập IMEI @Html.TextBoxFor(Model => Model.item.productID)</label>

                </div>

                <div class="section"><span>3</span>Thông tin bảo hành</div>
                @foreach (ThienNga2.Models.Entities.tb_warranty war in Model.warranties.TakeWhile(x => myFlag) )
                {
                String newId = "warrantyNo" + id;
                String divId = "warrantyDiv" + id;
                <div id=@divId class="inner-wrap">
                    <label>Mã bảo hành  @Html.TextBoxFor(Model => war.warrantyID)</label>
                    <label>Tên loại bảo hành @Html.TextBoxFor(Model => war.description)</label>
                    <label>Thời gian bảo hành @Html.DropDownListFor(Model => war.duration, ls)</label>
                 
                </div>
                // if (war.duration == 0) { myFlag = false; }
                id = id + 1;

                }
         
                <div class="button-section">
                    <input type="submit" name="Hoàn tất" />
                   
                </div>
            </form>
        </div>
       

    }




</body>
</html>
